# Created by zlaubste at 9/4/2015
Feature: Client Broker Affinity connectedBrokerGuid Tests

  Background:
    When I create a safe hub topology
    And I start all DXL brokers Services
    And I wait for "66" seconds

  @DXL_CLIENT_BROKER_AFFINITY_CLIENT_SIDE @FVT @FAILED_VALIDATION
  Scenario: Failover works when restrict to hub-n-children and stop both brokers
    Then Verify client "client_1" fails over correctly when x "2" in hub are stopped and client broker affinity is restricted to a hub with "True" descendants

  @DXL_CLIENT_BROKER_AFFINITY_CLIENT_SIDE @FVT @FAILED_VALIDATION
  Scenario: Failover works in hub when restricted to hub only stop client's broker
    Then Verify client "client_1" fails over correctly when x "1" in hub are stopped and client broker affinity is restricted to a hub with "False" descendants

  @DXL_CLIENT_BROKER_AFFINITY_CLIENT_SIDE @FVT @FAILED_VALIDATION
  Scenario: Failover works in hub when restricted to hub only stop both brokers
    Then Verify client "client_1" fails over correctly when x "2" in hub are stopped and client broker affinity is restricted to a hub with "False" descendants

  @DXL_CLIENT_BROKER_AFFINITY_CLIENT_SIDE @FVT @FAILED_VALIDATION
  Scenario: I clean up topology after Cl-Br Affinity connectedBrokerGuid Tests
    When I create a safe hub topology
    And I skip this scenario because "it is being used to clean up broker topology"